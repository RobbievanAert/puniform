{
    "contents" : "#' p-uniform\n#'\n#' Function to apply p-uniform method for one-sample mean, two-independent means, and one raw correlation coefficient as described in van Assen, van Aert, and Wicherts (2015) and van Aert, Wicherts, and van Assen (2015). \\cr\n#' \\cr\n#' Please note that the method is still in development and that this is a beta version. If you suspect a bug, please send me an email (\\email{R.C.M.vanAert@@tilburguniversity.edu}).\n#'\n#' @param mi A vector of group means for one-sample means\n#' @param ri A vector of raw correlations\n#' @param ni A vector of sample sizes for one-sample means and correlations\n#' @param sdi A vector of standard deviations for one-sample means\n#' @param m1i A vector of means in group 1 for two-independent means\n#' @param m2i A vector of means in group 2 for two-independent means\n#' @param n1i A vector of sample sizes in group 1 for two-independent means\n#' @param n2i A vector of sample sizes in group 2 for two-independent means\n#' @param sd1i A vector of standard deviations in group 1 for two-independent means\n#' @param sd2i A vector of standard deviations in group 2 for two-independent means\n#' @param tobs A vector of t-values\n#' @param alpha A integer specifying the alpha level as used in primary studies (default is 0.05).\n#' @param side A character indicating whether the effect sizes in the primary studies are in the right-tail of the distribution (i.e., positive)  or in the left-tail of the distribution (i.e., negative) (either \\code{\"right\"} or \\code{\"left\"})\n#' @param method A character indicating the method to be used (\\code{\"P\"} (default), \\code{\"LNP\"}, \\code{\"LN1MINP\"}, \\code{\"KS\"}, or \\code{\"AD\"})\n#' @param plot A logical indicating whether a plot showing the relation between observed and expected p-values has to be rendered (default is \\code{TRUE})\n#'\n#' @details Three different effect sizes can be used as input for the \\code{puniform} function: one-sample means, two-independent means, and raw correlation coefficients.\n#' Analyzing one-sample means and two-independent means can be done by either providing the function group means (\\code{mi} or \\code{m1i} and \\code{m2i}), standard deviations\n#' (\\code{sdi} or \\code{sd1i} and \\code{sd2i}), and sample sizes (\\code{ni} or \\code{n1i} and \\code{n2i}) or t-values (\\code{tobs}) and sample sizes (\\code{ni} or \\code{n1i}\n#' and \\code{n2i}). Both options should be accompanied with input for the arguments \\code{side} and \\code{method}. See the Example section for examples. Raw correlation\n#' coefficients can be analyzed by supplying \\code{ri} and \\code{ni} to the \\code{puniform} function next to input for the arguments \\code{side} and \\code{method}.\n#'\n#' P-uniform assumes that two-tailed hypothesis tests were conducted in the primary studies. In case one-tailed hypothesis tests were conducted in the primary studies, the\n#' alpha level has to be multiplied by two. For example, if one-tailed hypothesis tests were conducted with an alpha level of .05, an alpha of 0.1 has to be\n#' submitted to p-uniform.\n#'\n#' Note that only one effect size measure can be specified at a time. A combination of effect size measures usually causes true heterogeneity among effect sizes and including\n#' different effect size measures is therefore not recommended.\n#'\n#' Five different estimators can be used when applying p-uniform. The \\code{P} method is based on the distribution of the sum of independent uniformly distributed random\n#' variables (Irwin-Hall distribution) and is the recommended estimator (van Aert et al., 2015). The \\code{LNP} estimator refers to Fisher’s method (1950, Chapter 4)\n#' for combining p-values and the \\code{LN1MINP} estimator first computes 1 – p-value in each study before applying Fisher’s method on these transformed p-values\n#' (van Assen et al., 2015). \\code{KS} and \\code{AD} respectively use the Kolmogorov-Smirnov test (Massey, 1951) and the Anderson-Darling test (Anderson & Darling, 1954)\n#' for testing whether the (conditional) p-values follow a uniform distribution.\n#'\n#' @return\n#' \\item{est}{p-uniform's effect size estimate}\n#' \\item{ci.lb}{lower bound of p-uniform's confidence interval}\n#' \\item{ci.ub}{upper bound of p-uniform's confidence interval}\n#' \\item{ksig}{number of significant studies}\n#' \\item{L.0}{test statistic of p-uniform's test of null-hypothesis of no effect (for method \\code{\"P\"} a z-value)}\n#' \\item{pval.0}{one-tailed p-value of p-uniform's test of null-hypothesis of no effect}\n#' \\item{L.pb}{test statistic of p-uniform's publication bias test}\n#' \\item{pval.pb}{one-tailed p-value of p-uniform's publication bias test}\n#' \\item{est.fe}{effect size estimate based on traditional fixed-effect meta-analysis}\n#' \\item{se.fe}{standard error of effect size estimate based on traditional fixed-effect meta-analysis}\n#' \\item{zval.fe}{test statistic of the null-hypothesis of no effect based on traditional fixed-effect meta-analysis}\n#' \\item{pval.fe}{one-tailed p-value of the null-hypothesis of no effect based on traditional fixed-effect meta-analysis}\n#' \\item{ci.lb.fe}{lower bound of confidence interval based on traditional fixed-effect meta-analysis}\n#' \\item{ci.ub.fe}{ci.ub.fe upper bound of confidence interval based on traditional fixed-effect meta-analysis}\n#' \\item{Qstat}{test statistic of the Q-test for testing the null-hypothesis of homogeneity}\n#' \\item{Qpval}{one-tailed p-value of the Q-test}\n#'\n#' @author Robbie C.M. van Aert \\email{R.C.M.vanAert@@tilburguniversity.edu}\n#'\n#' @references Anderson, T. W., & Darling, D. A. (1954). A test of goodness of fit. Journal of the American Statistical Association, 49(268), 765-769.\n#' @references Fisher, R. A. (1950). Statistical methods for research workers (11th ed.). London: Oliver & Boyd.\n#' @references Massey, F. J. (1951). The Kolmogorov-Smirnov test for goodness of fit. Journal of the American Statistical Association, 46(253), 68-78.\n#' @references Van Aert, R. C. M., Wicherts, J. M., & Van Assen, M. A. L. M. (2015). Conducting meta-analyses on p-values: Reservations and recommendations for applying p-uniform and p-curve. Manuscript submitted for publication.\n#' @references Van Assen, M. A. L. M., Van Aert, R. C. M., & Wicherts, J. M. (2015). Meta-analysis using effect size distributions of only statistically significant studies. Psychological Methods, 20(3), 293-309. doi: http://dx.doi.org/10.1037/met0000025\n#'\n#' @examples ### Load data from meta-analysis by McCall and Carriger (1993)\n#' data(data.mccall93)\n#'\n#' ### Apply p-uniform method to get the same results as in van Assen et al. (2015)\n#' puniform(ri = data.mccall93$ri, ni = data.mccall93$ni, alpha = .025, side = \"right\", method = \"LNP\", plot = TRUE)\n#'\n#' ### Note that the results of the publication bias test of p-uniform are not exactly equal to the results as stated in van Assen et al. (2015).\n#' ### This is caused by a minor mistake in the analyses in van Assen et al. (2015).\n#'\n#' ### Generate some example data\n#' set.seed(123)\n#' ni <- 100\n#' sdi <- 1\n#' mi <- rnorm(8, mean = 0.2, sd = sdi/sqrt(ni))\n#' tobs <- mi/(sdi/sqrt(ni))\n#'\n#' ### Apply p-uniform method based on sample means\n#' puniform(mi = mi, ni = ni, sdi = sdi, alpha = 0.05, side = \"right\", method = \"P\", plot = FALSE)\n#'\n#' ### Apply p-uniform method based on t-values\n#' puniform(ni = ni, tobs = tobs, alpha = 0.05, side = \"right\", method = \"P\", plot = FALSE)\n#'\n#' @export\n\npuniform <- function(mi, ri, ni, sdi, m1i, m2i, n1i, n2i, sd1i, sd2i, tobs, alpha = .05, side, method, plot = TRUE) {\n\n  if (!missing(\"mi\") & !missing(\"ni\") & !missing(\"sdi\")) {\n    measure <- \"M\"\n    es <- escompute(mi = mi, ni = ni, sdi = sdi, alpha = alpha/2, side = side, measure = measure)\n  } else if (!missing(\"ni\") & !missing(\"tobs\")) {\n    measure <- \"MT\"\n    es <- escompute(ni = ni, tobs = tobs, alpha = alpha/2, side = side, measure = measure)\n  } else if (!missing(\"m1i\") & !missing(\"m2i\") & !missing(\"n1i\") & !missing(\"n2i\") & !missing(\"sd1i\") & !missing(\"sd2i\")) {\n    measure <- \"MD\"\n    es <- escompute(m1i = m1i, m2i = m2i, n1i = n1i, n2i = n2i, sd1i = sd1i, sd2i = sd2i, alpha = alpha/2, side = side, measure = measure)\n  } else if (!missing(\"n1i\") & !missing(\"n2i\") & !missing(\"tobs\")) {\n    measure <- \"MDT\"\n    es <- escompute(n1i = n1i, n2i = n2i, tobs = tobs, alpha = alpha/2, side = side, measure = measure)\n  } else if (!missing(\"ri\") & !missing(\"ni\")) {\n    measure <- \"COR\"\n    es <- escompute(ri = ri, ni = ni, alpha = alpha/2, side = side, measure = measure)\n  }\n\n  res1 <- pubbias(es = es, alpha = alpha/2, method = method)\n\n  if(res1$ksig == 0) {\n    stop(\"No significant studies on the specified side\")\n  }\n\n  res2 <- testeffect(zval = res1$data$zval, zcv = res1$data$zcv, ksig = res1$ksig, method = method)\n\n  res3 <- esest(yi = res1$data$yi, vi = res1$data$vi, zval = res1$data$zval, zcv = res1$data$zcv, ksig = res1$ksig, method = method)\n\n  if(plot == TRUE) { plottrans(tr.q = res3$tr.q, ksig = res1$ksig) }\n\n  res5 <- transform(res1 = res1, res3 = res3, side = side, measure = measure)\n\n  x <- list(method = method, est = res5$est, ci.lb = res5$ci.lb, ci.ub = res5$ci.ub, ksig = res1$ksig, approx.est = res3$approx.est,\n            approx.ci.lb = res3$approx.ci.lb, ext.lb = res3$ext.lb, L.0 = res2$L.0, pval.0 = res2$pval.0, approx.0.imp = res2$approx.0.imp,\n            L.pb = res1$L.pb, pval.pb = res1$pval.pb, approx.pb = res1$approx.pb, est.fe = res5$est.fe, se.fe = res5$se.fe, zval.fe = res5$zval.fe,\n            pval.fe = res1$pval.fe, ci.lb.fe = res5$ci.lb.fe, ci.ub.fe = res5$ci.ub.fe, Qstat = res1$Qstat, Qpval = res1$Qpval)\n\n  class(x) <- \"puniformoutput\"\n  return(x)\n\n}\n",
    "created" : 1455093170708.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2245945338",
    "id" : "5AEE3474",
    "lastKnownWriteTime" : 1455094839,
    "path" : "D:/Dropbox/Werk/Onderzoek/Code/puniform/R/GIT_puniform_compleet_9.R",
    "project_path" : "R/GIT_puniform_compleet_9.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}